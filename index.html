<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>চাঁদার হিসাব</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Noto Sans Bengali', sans-serif;
            background:#f5f5f5; color:#333; line-height:1.6; padding:20px;
        }

        .container {
            max-width:800px; margin:0 auto; background:#fff;
            border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);
            overflow:hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color:white; padding:25px 20px; text-align:center;
        }
        header h1 { font-size:1.8rem; margin-bottom:10px; }
        .total-amount { font-size:2.2rem; font-weight:bold; }

        .expense-form { padding:25px 20px; border-bottom:1px solid #eee; }
        .form-group { margin-bottom:15px; }
        .form-group label { display:block; margin-bottom:5px; font-weight:500; color:#555; }
        .form-group input, .form-group select {
            width:100%; padding:12px; border:1px solid #ddd; border-radius:6px; font-size:16px;
        }

        button {
            background-color:#667eea; color:white; border:none;
            padding:12px 20px; border-radius:6px; cursor:pointer;
            font-size:16px; font-weight:500; transition:0.2s;
        }
        button:hover { background-color:#5a6fd8; }

        .expenses-list { padding:20px; }
        .expenses-list h2 { margin-bottom:15px; color:#444; font-size:1.3rem; }

        .expense-item {
            display:flex; justify-content:space-between; align-items:center;
            padding:15px; border-bottom:1px solid #eee; transition:0.2s;
        }
        .expense-item:hover { background:#f9f9f9; }

        .expense-name { font-weight:500; font-size:1.1rem; margin-bottom:5px; }
        .expense-category { font-size:0.9rem; color:#666; background:#f0f0f0; padding:3px 8px; border-radius:12px; }

        .expense-amount { font-weight:bold; color:#e74c3c; margin-right:15px; }
        .expense-date { color:#888; font-size:0.9rem; }

        .delete-btn { background:#ff4757; padding:8px 12px; border-radius:4px; font-size:14px; }
        .delete-btn:hover { background:#ff3742; }

        .no-expenses { text-align:center; padding:30px; color:#888; }

        @media(max-width:600px){
            .expense-item{flex-direction:column; align-items:flex-start;}
            .expense-actions{margin-top:10px; align-self:flex-end;}
        }
    </style>
</head>

<body>
<div class="container">

    <header>
        <h1>চাঁন্দা ভাইয়ের চাঁদার হিসাব</h1>
        <p>মোট চাঁদা:</p>
        <div class="total-amount" id="মোট_চাঁদা">৳০.০০</div>
    </header>

    <button id="downloadExcelBtn" style="margin:15px; background:#28a745;">এক্সেল ডাউনলোড করুন</button>

    <section class="expense-form">
        <h2>নতুন চাঁদার সংযোজন</h2>

        <form id="চাঁদা_ফর্ম">
            <div class="form-group">
                <label for="চাঁদার_খাত">চাঁদার খাত</label>
                <input type="text" id="চাঁদার_খাত" placeholder="যেমন: বাজার, ভাড়া" required>
            </div>

            <div class="form-group">
                <label for="চাঁদার_পরিমাণ">চাঁদার পরিমাণ (৳)</label>
                <input type="number" id="চাঁদার_পরিমাণ" min="0.01" step="0.01" placeholder="০.০০" required>
            </div>

            <div class="form-group">
                <label for="চাঁদার_ধরণ">চাঁদার ধরণ</label>
                <select id="চাঁদার_ধরণ" required>
                    <option value="">নির্বাচন করুন</option>
                    <option value="খাবার">খাবার</option>
                    <option value="পরিবহন">পরিবহন</option>
                    <option value="বিনোদন">বিনোদন</option>
                    <option value="ইউটিলিটি">ইউটিলিটি</option>
                    <option value="শপিং">শপিং</option>
                    <option value="অন্যান্য">অন্যান্য</option>
                </select>
            </div>

            <div class="form-group">
                <label for="চাঁদার_তারিখ">তারিখ</label>
                <input type="date" id="চাঁদার_তারিখ" required>
            </div>

            <button type="submit">সংযোজন করুন</button>
        </form>
    </section>

    <section class="expenses-list">
        <h2>সাম্প্রতিক চাঁদা</h2>
        <div id="expensesContainer">
            <div class="no-expenses">কোনো চাঁদা নেই। উপরে নতুন চাঁদা সংযোজন করুন!</div>
        </div>
    </section>

</div>


<script>
// বাংলা সংখ্যা রূপান্তর
function toBanglaNumber(number){
    const bangla = ['০','১','২','৩','৪','৫','৬','৭','৮','৯'];
    return number.toString().replace(/\d/g, d => bangla[d]);
}

// LocalStorage helpers
function getExpenses(){ return JSON.parse(localStorage.getItem("expenses")) || []; }
function saveExpenses(list){ localStorage.setItem("expenses", JSON.stringify(list)); }

// Load UI
document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("চাঁদার_তারিখ").valueAsDate = new Date();
    loadExpenses();
    updateTotal();

    document.getElementById("চাঁদা_ফর্ম").addEventListener("submit", function(e){
        e.preventDefault();
        addExpense();
    });
});

// Add expense
function addExpense(){
    const name = document.getElementById("চাঁদার_খাত").value.trim();
    const amount = document.getElementById("চাঁদার_পরিমাণ").value;
    const category = document.getElementById("চাঁদার_ধরণ").value;
    const date = document.getElementById("চাঁদার_তারিখ").value;

    if(!name || !amount || !category || !date){
        alert("সব ফিল্ড পূরণ করুন!");
        return;
    }

    const expenses = getExpenses();
    expenses.push({
        name,
        amount: parseFloat(amount),
        category,
        date
    });

    saveExpenses(expenses);
    loadExpenses();
    updateTotal();

    document.getElementById("চাঁদা_ফর্ম").reset();
    document.getElementById("চাঁদার_তারিখ").valueAsDate = new Date();
}

// Load list
function loadExpenses(){
    const list = getExpenses();
    const box = document.getElementById("expensesContainer");
    box.innerHTML = "";

    if(list.length === 0){
        box.innerHTML = '<div class="no-expenses">কোনো চাঁদা নেই।</div>';
        return;
    }

    list.sort((a,b)=> new Date(b.date) - new Date(a.date));

    list.forEach((exp, index) => {
        const d = new Date(exp.date).toLocaleDateString('bn-BD',{year:'numeric',month:'short',day:'numeric'});
        const row = document.createElement("div");
        row.className = "expense-item";

        row.innerHTML = `
            <div>
                <div class="expense-name">${exp.name}</div>
                <span class="expense-category">${exp.category}</span>
                <span class="expense-date">${d}</span>
            </div>

            <div class="expense-actions">
                <span class="expense-amount">৳${toBanglaNumber(exp.amount.toFixed(2))}</span>
                <button class="delete-btn" onclick="deleteExpense(${index})">মুছুন</button>
            </div>
        `;

        box.appendChild(row);
    });
}

// Delete
function deleteExpense(index){
    const list = getExpenses();
    list.splice(index,1);
    saveExpenses(list);
    loadExpenses();
    updateTotal();
}

// Update total
function updateTotal(){
    const list = getExpenses();
    const total = list.reduce((s,x)=> s + x.amount, 0);
    document.getElementById("মোট_চাঁদা").textContent = "৳" + toBanglaNumber(total.toFixed(2));
}

// Excel download
document.getElementById("downloadExcelBtn").addEventListener("click", () => {
    const list = getExpenses();
    if(list.length === 0){
        alert("কোনো চাঁদা নেই!");
        return;
    }

    const data = [
        ["চাঁদার খাত","পরিমাণ (৳)","ধরণ","তারিখ"],
        ...list.map(e => [
            e.name,
            e.amount,
            e.category,
            e.date
        ])
    ];

    const ws = XLSX.utils.aoa_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Chanda");

    XLSX.writeFile(wb, "chanda.xlsx");
});
</script>

</body>
</html>
