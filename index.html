<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ব্যয়ের হিসাব</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        /* Reset & Base */
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Noto Sans Bengali', sans-serif, sans-serif;
            background:#f5f5f5; color:#333; line-height:1.6; padding:20px;
        }

        /* Container */
        .container {
            max-width:800px; margin:0 auto; background:#fff;
            border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);
            overflow:hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color:white; padding:25px 20px; text-align:center;
        }
        header h1 { font-size:1.8rem; margin-bottom:10px; }
        .total-amount { font-size:2.2rem; font-weight:bold; }

        /* Form */
        .expense-form { padding:25px 20px; border-bottom:1px solid #eee; }
        .form-group { margin-bottom:15px; }
        .form-group label { display:block; margin-bottom:5px; font-weight:500; color:#555; }
        .form-group input, .form-group select {
            width:100%; padding:12px; border:1px solid #ddd; border-radius:6px; font-size:16px;
        }
        .form-group input:focus, .form-group select:focus {
            outline:none; border-color:#667eea;
            box-shadow:0 0 0 2px rgba(102,126,234,0.2);
        }
        button {
            background-color:#667eea; color:white; border:none;
            padding:12px 20px; border-radius:6px; cursor:pointer;
            font-size:16px; font-weight:500; transition:0.2s;
        }
        button:hover { background-color:#5a6fd8; }

        /* Expenses List */
        .expenses-list { padding:20px; }
        .expenses-list h2 { margin-bottom:15px; color:#444; font-size:1.3rem; }
        .expense-item {
            display:flex; justify-content:space-between; align-items:center;
            padding:15px; border-bottom:1px solid #eee; transition:0.2s;
        }
        .expense-item:hover { background:#f9f9f9; }
        .expense-details { flex:1; }
        .expense-name { font-weight:500; font-size:1.1rem; margin-bottom:5px; }
        .expense-category { font-size:0.9rem; color:#666; background:#f0f0f0; padding:3px 8px; border-radius:12px; display:inline-block; }
        .expense-amount { font-weight:bold; color:#e74c3c; margin-right:15px; }
        .expense-date { color:#888; font-size:0.9rem; }
        .delete-btn { background:#ff4757; color:white; border:none; padding:8px 12px; border-radius:4px; cursor:pointer; font-size:14px; }
        .delete-btn:hover { background:#ff3742; }
        .no-expenses { text-align:center; padding:30px; color:#888; }

        /* Responsive */
        @media(max-width:600px){
            .expense-item{flex-direction:column; align-items:flex-start;}
            .expense-actions{margin-top:10px; align-self:flex-end;}
            .expense-form{padding:20px 15px;}
            .expenses-list{padding:15px;}
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>ব্যয়ের হিসাব</h1>
        <p>মোট ব্যয়:</p>
        <div class="total-amount" id="মোট ব্যয়">৳০.০০</div>
    </header>

    <button id="downloadExcelBtn" style="margin:15px; background:#28a745;">এক্সেল ডাউনলোড করুন</button>

    <section class="expense-form">
        <h2>নতুন ব্যয় সংযোজন</h2>
        <form id="নতুন ব্যয় সংযোজন">
            <div class="form-group">
                <label for="ব্যয়ের খাত">ব্যয়ের খাত</label>
                <input type="text" id="ব্যয়ের খাত" placeholder="যেমন: বাজার, ভাড়া" required>
            </div>

            <div class="form-group">
                <label for="পরিমাণ">পরিমাণ (৳)</label>
                <input type="number" id="পরিমাণ" min="0.01" step="0.01" placeholder="০.০০" required>
            </div>

            <div class="form-group">
                <label for="খাতের ধরণ">খাতের ধরণ:</label>
                <select id="খাতের ধরণ" required>
                    <option value="">একটি ধরণ নির্বাচন করুন</option>
                    <option value="খাবার">খাবার</option>
                    <option value="পরিবহন">পরিবহন</option>
                    <option value="বিনোদন">বিনোদন</option>
                    <option value="ইউটিলিটি">ইউটিলিটি</option>
                    <option value="শপিং">শপিং</option>
                    <option value="অন্যান্য">অন্যান্য</option>
                </select>
            </div>

            <div class="form-group">
                <label for="expenseDate">তারিখ</label>
                <input type="date" id="expenseDate" required>
            </div>

            <button type="submit">সংযোজন করুন</button>
        </form>
    </section>

    <section class="expenses-list">
        <h2>সাম্প্রতিক ব্যয়</h2>
        <div id="expensesContainer">
            <div class="no-expenses">কোনো ব্যয় নেই। উপরে নতুন ব্যয় সংযোজন করুন!</div>
        </div>
    </section>
</div>

<script>
// বাংলা সংখ্যা রূপান্তর
function toBanglaNumber(number) {
    const banglaDigits = ['০','১','২','৩','৪','৫','৬','৭','৮','৯'];
    return number.toString().split('').map(d => banglaDigits[d] || d).join('');
}

document.addEventListener('DOMContentLoaded', function(){
    initApp();
    document.getElementById('expenseDate').valueAsDate = new Date();

    document.getElementById('নতুন ব্যয় সংযোজন').addEventListener('submit', function(e){
        e.preventDefault();
        addExpense();
    });
});

function initApp(){
    loadExpenses();
    updateTotal();
}

function getExpenses(){ return JSON.parse(localStorage.getItem('expenses'))||[]; }
function saveExpenses(exp){ localStorage.setItem('expenses', JSON.stringify(exp)); }

function loadExpenses(){
    const expenses = getExpenses();
    const container = document.getElementById('expensesContainer');
    container.innerHTML='';
    if(expenses.length===0){ container.innerHTML='<div class="no-expenses">কোনো ব্যয় নেই। উপরে নতুন ব্যয় সংযোজন করুন!</div>'; return; }

    expenses.sort((a,b)=>new Date(b.date)-new Date(a.date));
    expenses.forEach((exp,i)=>container.appendChild(createExpenseElement(exp,i)));
}

function createExpenseElement(expense,index){
    const date = new Date(expense.date).toLocaleDateString('bn-BD',{year:'numeric',month:'short',day:'numeric'});
    const amount = toBanglaNumber(parseFloat(expense.amount).toFixed(2));
    const elem = document.createElement('div');
    elem.className='expense-item';
    elem.innerHTML=`
        <div class="expense-details">
            <div class="expense-name">${expense.name}</div>
            <div>
                <span class="expense-category">${expense.category}</span>
                <span class="expense-date">${date}</span>
            </div>
        </div>
        <div class="expense-actions">
            <span class="expense-amount">৳${amount}</span>
            <button class="delete-btn" data-index="${index}">মুছুন</button>
        </div>
    `;
    elem.querySelector('.delete-btn').addEventListener('click',()=>deleteExpense(index));
    return elem;
}

function addExpense(){
    const name=document.getElementById('ব্যয়ের খাত').value.trim();
    const amount=document.getElementById('পরিমাণ').value;
    const category=document.getElementById('খাতের ধরণ').value;
    const date=document.getElementById('expenseDate').value;

    if(!name||!amount||!category||!date){ alert('সব ফিল্ড পূরণ করুন'); return; }

    const newExp={name:name, amount:parseFloat(amount), category:category, date:date};
    const expenses=getExpenses();
    expenses.push(newExp);
    saveExpenses(expenses);
    loadExpenses(); updateTotal();
    document.getElementById('নতুন ব্যয় সংযোজন').reset();
    document.getElementById('expenseDate').valueAsDate=new Date();
}

function deleteExpense(index){
    const expenses=getExpenses();
    expenses.splice(index,1);
    saveExpenses(expenses);
    loadExpenses(); updateTotal();
}

function updateTotal(){
    const expenses=getExpenses();
    const total = expenses.reduce((sum, exp)=>sum+parseFloat(exp.amount),0);
    document.getElementById('মোট ব্যয়').textContent='৳'+toBanglaNumber(total.toFixed(2));
}

// Excel Download
document.getElementById('downloadExcelBtn').addEventListener('click',function(){
    const expenses=getExpenses();
    if(expenses.length===0){ alert("কোনো ব্যয় নেই!"); return; }

    const data=[["ব্যয়ের খাত","পরিমাণ (৳)","খাতের ধরণ","তারিখ"],
        ...expenses.map(exp=>[exp.name,toBanglaNumber(parseFloat(exp.amount).toFixed(2)),exp.category,exp.date])
    ];

    const ws=XLSX.utils.aoa_to_sheet(data);
    const wb=XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws,"Expenses");
    XLSX.writeFile(wb,"expenses.xlsx");
});
</script>
</body>
</html>
